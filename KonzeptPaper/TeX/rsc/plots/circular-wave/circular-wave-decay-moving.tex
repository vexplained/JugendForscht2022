% arara: lualatex
% TODO https://tex.stackexchange.com/questions/136658/how-to-make-pdflatex-multithreaded-when-shell-escape-is-enabled
\begin{tikzpicture}
    [
        declare function={
                %! IMPORTANT: NO space between function arguments (in front paranthesis)
                distcent(\x,\y) = sqrt(\x^2 + \y^2);
                a(\x,\y) = sin(deg(\wk * distcent(\x, \y) - \womega * \wtime + \wphi));
                adecay(\x, \y) = \wamp * a(\x, \y) / distcent(\x, \y)
                ;
                winkel(\x,\y) =
                and(\x >= 0, \y >= 0) * (rad(atan(\y / \x))) +
                (\x < 0) * (pi + rad(atan(\y / \x))) +
                and(\x >= 0, \y < 0) * (2 * pi + rad(atan(\y / \x)))
                ;
                cscale(\x,\y) = cos(deg(winkel(\x, \y))) + 2;
                b(\x,\y) = a(\x * cscale(\x, \y), \y * cscale(\x, \y));
                bdecay(\x,\y) = adecay(\x * cscale(\x, \y), \y * cscale(\x, \y));
            }
    ]

    \def\wtime{14}
    \def\wlambda{15}
    \def\wk{2 * pi / \wlambda}
    \def\womega{1}
    \def\wphi{0}
    \def\wamp{3}

    \def\xydomain{25}

    \begin{axis}
        [
            xlabel={$x$},
            ylabel={$y$},
            zlabel={Amplitude},
            % colorbar,
            colormap/PuOr,
            % view={40}{50},
            view/v=35, % only change vert rotation
            xmin=-\xydomain-15,
            xmax=\xydomain-5,
            ymin=-\xydomain,
            ymax=\xydomain,
            zmin=-2,
            zmax=4,
        ]
        \addplot3
        [
            surf,
            x domain=-40:20,
            y domain=-30:30,
            % samples=30,
            samples=60,
            shader=faceted interp,
        ]
        {
            b(x,y)
        };
    \end{axis}
\end{tikzpicture}