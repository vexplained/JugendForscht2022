% arara: lualatex
% TODO https://tex.stackexchange.com/questions/136658/how-to-make-pdflatex-multithreaded-when-shell-escape-is-enabled
\begin{tikzpicture}
    [
        declare function={
                %! IMPORTANT: NO space between function arguments (in front paranthesis)
                distcent(\x,\y) = sqrt(\x^2 + \y^2);
                a(\x,\y) = sin(deg(\wk * distcent(\x, \y) - \womega * \wtime + \wphi));
                adecay(\x,\y) = \wamp * a(\x, \y) / sqrt(distcent(\x, \y)) %* info: added extra sqrt
                ;
                winkel(\x,\y) =
                and(\x >= 0, \y >= 0) * (rad(atan(\y / \x))) +
                (\x < 0) * (pi + rad(atan(\y / \x))) +
                and(\x >= 0, \y < 0) * (2 * pi + rad(atan(\y / \x)))
                ;
                cscale(\x,\y) = cos(deg(winkel(\x, \y))) + 2;
                b(\x,\y) = a(\x * cscale(\x, \y), \y * cscale(\x, \y));
                bdecay(\x,\y) = adecay(\x * cscale(\x,\y), \y * cscale(\x,\y));
            }
    ]

    \def\wtime{13.4}
    \def\wlambda{15}
    \def\wk{2 * pi / \wlambda}
    \def\womega{1}
    \def\wphi{0}
    \def\wamp{6}


    \begin{axis}
        [
            xlabel={$x$},
            ylabel={$y$},
            colorbar,
            colorbar style = {
                    ylabel=Amplitude (StÃ¶rung),
                    ytick={-2, -1, ..., 3},
                    align=right,
                },
            colormap/PuOr,
            % view={40}{50},
            view/v=65, % only change vert rotation
            xmin=-40,
            xmax=20,
            ymin=-30,
            ymax=30,
            zmin=-2,
            zmax=4,
        ]
        \addplot3
        [
            surf,
            domain=-40:20,
            domain y=-30:30,
            samples=50,
            shader=faceted interp,
        ]
        {
            bdecay(x,y)
        };
    \end{axis}
\end{tikzpicture}